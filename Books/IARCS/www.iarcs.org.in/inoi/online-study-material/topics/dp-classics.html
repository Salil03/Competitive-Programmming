<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>

<meta name="Description" content="">
<meta name="author" content="">
<meta name="keywords" content="">

<meta name="robots" content="all,follow">

<!-- CSS --> 
<link rel="stylesheet" href="styles\default.css" type="text/css" media="screen, projection, tv">
<link rel="stylesheet" href="styles\print.css" type="text/css" media="print">

<!-- Favicon -->
<link rel="shortcut icon" href="img\iarcslogo.png" type="image/x-icon">
</head>

<body id="top">
<div id="wrapper">

	<div class="header">
	<h1><span><a href="http://www.iarcs.org.in/inoi"><span id="color">Indian Computing Olympiad</span></a></span></h1>
	<p id="about">Training Material</p>

	<a href="#skip-menu" class="hidden">Skip menu</a> <!-- Skip menu -->
	<div id="menu-box">
	  <ul id="web">
	    <li><a href="..\contact\index.html">Contact</a></li>
	    <li><a href="..\iindex\index.html">Index</a></li>
	    <li><a href="..\problems\index.html">Problems</a></li>
	    <li><a class="active" id="first" href="index-1.html">Topics</a></li>
	    <li><a href="..\index-1.html">Home</a></li>
	  </ul>
	</div>

	</div> <!-- Header end -->

<hr class="noscreen">

<div id="skip-menu"></div>

<div class="page">
  <div class="col-r">
    <div class="col-r-in">

      <h2><a href="dp.html">Dynamic Programming</a></h2>

      <h3><span>Other classical problems</span></h3>

      <br>

      <div id="dp-longest-common-subword">
	<h3><span>Longest common subword</span></h3>
      </div>

      <p>
	Suppose we have two words made up from some letters, such as
      </p>

      <ul>
	<li>V = T G A T G G A T C</li>
	<li>W = G T T T G C A C</li>
      </ul>
      
      <p>
	We want to find the longest contiguous sequence of
	letters (subword) that is contained in both words.  In
	this case, the longest common subword is "T G".
      </p>

      <p><b>Solution</b></p>

      <ul>

	<li>LCSW[i,j] = length of longest common subword starting at
          position i in V and position j in W</li>

	<li>LCSW[i,j] = 0, if V[i] != W[j]<br>
	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             = 1 + LCSW[i+1,j+1], otherwise</li>
	<li> Base case:</li>

	<ul>
	  <li> LCSW[M,j] = 1 if V[N] = W[j], 0 otherwise</li>
	  <li> LCSW[i,N] = 1 if V[i] = W[N], 0 otherwise</li>
	</ul>
      </ul>

      <p>
	We calculate B[i,j] in an M x N array.  We know the
	values in the last row and last column from the base
	case.  Once we know the value at (i+1,j+1), we can
	compute the value at (i,j).  So, we can systematically
	fill up the values for B[i,j] row by row, right to left,
	starting from the bottom (or, equivalently, column by
	column, bottom to top, starting from the right).
      </p>

      <div id="dp-longest-common-subsequence">
	<h3><span>Longest common subsequence</span></h3>
      </div>

      <p>
	As before, we have two words over some letters, such as
      <p>

      <ul>
	<li>V = T G A T G G A T C</li>
	<li>W = G T T T G C A C</li>
      </ul>

      <p>
	Now we can drop some positions and obtain a subsequence.
	For instance "T G A C" is a subsequence of both
	words.  Our aim is to find the length of the longest
	common subsequence.
      </p>

      <p><b>Solution</b></p>

      <ul>
	<li>
	  LCSS[i,j] = length of longest common subsequence in the words
               V[i] V[i+1] ... V[M] and W[j] W[j+1] ... W[N]</li>
	<li>
	  LCSS[i,j] = LCSS[i+1,j+1] + 1,              if V[i] = W[j]<br>
	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             = max (LCSS[i+1,j], LCSS[i,j+1]), otherwise</li>

      </ul>

      <p>
	Once again, we can fill up the values LCSS[i,j] in an M x
	N array, starting with the last row and column as base
	cases.
      </p>

      <ul>
	<li>
	  LCSS[M,j] = 1 if V[M] appears anywhere in W[j] ... W[N]
	</li>
      </ul>

      <p>
	Fill the last row from right to left and once we fill a
	1, all entries to the left are 1.
      </p>

      <p>
	Similarly
      </p>

      <ul>
	<li>
	  LCSS[j,N] = 1 if W[N] appears anywhere in V[j] ... V[N]
	</li>
      </ul>

      <p>
	Fill the last column from bottom to top and once we fill a 1,
	all entries above are 1.
      </p>


      <h3><span>Exercise</span></h3>

      <p>
	The recurrences for LCSW and LCSS only tell us the
	lengths of the longest common subword and subsequence,
	respectively.  How do we recover a witness &mdash; that
	is, a common subword or subsequence of this maximum
	length?
      </p>

      <p>
	For subword it is easy &mdash; since we know the position where the longest
	common subword starts, we can read off the subword.
      </p>

      <p>
	How do we do it for longest common subsequence?
      </p>

      <div id="dp-longest-ascending-subsequence">
	<h3><span>Longest ascending subsequence</span></h3>
      </div>


      <p>
	Let s = a[1] a[2] ... a[n] be an unsorted sequence of
	numbers.  A <em>subsequence</em> of s is one in which we
	drop some elements and retain the rest (so we need not
	pick up a contiguous segment, but we preserve the order
	of elements).
      </p>

      <p>
	For instance, a[1] a[3] a[n] is a subsequence.
      </p>

      <p><b>Problem:</b>
	Find the (length of the) longest ascending subsequence.
      </p>



      <p><b>Solution 1</b></p>

      <p>
	Sort the array and find the longest common subsequence
	between sorted sequence and original sequence.
      </p>

      <p>
	This takes time O(n<sup>2</sup>) (sorting takes time
	O(n&nbsp;log&nbsp;n) and longest common subsequence takes
	O(n<sup>2</sup>).
      </p>

      <p><b>Solution 2</b></p>

      <p>
	A direct dynamic programming solution for this problem.
      </p>

      <ul>

	<li>
	  LAS[i] : length of longest ascending subsequence in that ends
           with a[i] (and hence only contains elements from a[1]
           a[2] ... a[i])
	</li>

	<li>
	  LAS[1]   = 1
	</li>

	<li>
	  LAS[i+1] = 1 + max { LAS[j] | 1 <= j <= i, a[j] <= a[i+1] }<br><br>

          i.e. to find the length of the longest ascending subsequence
          ending at a[i+1], look at all values to the left of
          a[i+1] that are less than or equal to a[i+1] and pick
          the position among these with the maximum LAS value.
        </li>

      </ul>

      <p>
	This can be computed in an array.  This takes time
	O(n<sup>2</sup>) &mdash; for each LAS[i], we have to scan
	values from LAS[1] to LAS[i-1].
      </p>

      <p>
	This solution is no better than our initial solution of sorting
	the sequence and then computing the longest common
	subsequence.
      </p>

      <p>
	We can improve the second solution to solve the problem
	in O(n log n) by maintaining an additional array M.
      </p>

      <ul>

	<li>
	  M[j] = of all the longest ascending subsequences of length j,
          M[i] is the smallest final value<br><br>

	  M[j] = min { a[k] | 1 <= k <= j, LAS[k] = j }
	</li>

      </ul>

      <p>
	Observe that M[j]'s always form an ascending sequence.
	So, we can find M[j-1] <= a[i] < M[j] using binary
	search.
      </p>

      <p>
	Adding a[i] requires log(i) time. 
	Overall we make n updates, so the overall algorithm is
	O(n&nbsp;log&nbsp;n).
      </p>

      <p>
	An example:
      </p>

      <pre>
	i       1    2    3    4    5    6    7    8

	a[i]    8    2    7    3    9    4    6    5

	LAS[i]  1    1    2    2    3    3    4    4

	M[i]    8X   7X   9X   6X
	        2    3    4    5
      </pre>

      <div id="dp-maximum-sum-subsection">
	<h3><span>Maximum sum subsection</span></h3>
      </div>

      <p>
	Given a sequence of integers, a subsection is a block of
	contiguous integers in the sequence.  The task is to find
	the subsection whose sum is maximum.
      </p>

      <p>
	For instance, here is a sequence and a subsection marked
	out whose sum is -1. 
      </p>

      <pre>
        3 -1  2 -1  2 -3  4 -2  1  2  1
          |<------------>|
              sum = -1
      </pre>

      <p>
	Find an O(N) algorithm for this problem.
      </p>

      <p><b>Solution</b></p>

      <ul>
	<li> Best(i)  = Maximum sum segment ending at i</li>

	<li> Best(i) = max { A[i],               // Best segment starts here<br>
	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  A[i] + Best(i-1)    // Best segment extends previous<br>
	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                }
	  </li>

	<li> Best(1) = A[1]</li>

      </ul>
      
      <p>
	This assumes subsections are of length > 0.  If zero
        length segments are permitted, we also have to add a term
        0 to the max term when computing Best(i).  (For instance,
        if all values are negative, the maximum sum subsection
        would then be the empty subsection with sum 0.)
      </p>				  


      <div id="video-material">
	<h3><span>Video material</span></h3>
      </div>

      <p>Video lecture on <em>Dynamic programming, classic problems</em>,
	<a href="https://onlinecourses.nptel.ac.in/explorer">
	  NPTEL online course</a> on
        <a href="https://onlinecourses.nptel.ac.in/noc15_cs02/preview">
  	  Design and Analysis of Algorithms</a>

      <ul>
        <li> Longest common subword and subsequence
        (<a href="http://www.cmi.ac.in/~madhavan/nptel-algorithms-2015/week7/pdf/nptel-week7-module4-lcs.pdf" target="_blank">Lecture slides</a>)<p>
      
        <iframe width="560" height="315" src="https://www.youtube.com/embed/xdA41xLxwuM" frameborder="0" allowfullscreen=""></iframe>

        <li> Edit distance
        (<a href="http://www.cmi.ac.in/~madhavan/nptel-algorithms-2015/week7/pdf/nptel-week7-module5-edit-distance.pdf" target="_blank">Lecture slides</a>)<p>

        <iframe width="560" height="315" src="https://www.youtube.com/embed/3KMX8tBToLA" frameborder="0" allowfullscreen=""></iframe>

        <li> Matrix multiplication
        (<a href="http://www.cmi.ac.in/~madhavan/nptel-algorithms-2015/week7/pdf/nptel-week7-module6-matrix-multiplication.pdf" target="_blank">Lecture slides</a>)<p>

        <iframe width="560" height="315" src="https://www.youtube.com/embed/xWni5uErQhI" frameborder="0" allowfullscreen=""></iframe>

      </li></ul>

      <br><br>

    </div>
  </div> <!-- Right column end -->


    <hr class="noscreen">

  <div class="col-l">
    <div class="col-l-in">
      <h3>Basic topics</h3>
      <ul class="menu">
	<li><a href="introduction.html">Introduction</a></li>
	<li><a href="efficiency.html">Efficiency</a></li>
	<li><a href="binarysearch.html">Searching</a></li>
	<li><a href="sorting.html">Sorting</a></li>
	<li><a href="graphs.html">Basic Graph Algorithms</a></li>
	<li><a href="dp.html">Dynamic Programming</a></li>
	<li><a href="greedy.html">Greedy Algorithms</a></li>
	<li><a href="shortest-paths.html">Computing Shortest Paths</a></li>
	<li><a href="heaps.html">Heaps</a></li>
	<li><a href="permutations.html">Permutations</a></li>
	<li><a href="dags.html">Directed Acyclic Graphs</a></li>
	<li><a href="prefix-sums.html">Computing Prefix Sums</a></li>
	<li><a href="sliding-window.html">Sliding Window Algorithms</a></li>
      </ul>

      <h3>Advanced topics</h3>
      <ul class="menu">
	<li><a href="advanced-graph-algorithms.html">Advanced Graph Algorithms</a></li>
	<li><a href="dp-trees.html">Dynamic Programming on Trees</a></li>
	<li><a href="range-queries.html">Range Queries</a></li>
	<li><a href="network-flows.html">Network Flows</a></li>
	<li><a href="games.html">Games and Strategies</a></li>
	<li><a href="geometry.html">Geometry</a></li>
      </ul>


      <br>

    </div>
  </div> <!-- Left column end -->

  <div class="cleaner">&nbsp;</div>

        </div> <!-- Page end -->

        <div id="footer">
                <ul>
                  <li><a href="..\index-1.html">Home</a>|</li>
                  <li><a href="">Topics</a>|</li>
                  <li><a href="..\problems\index.html">Problems</a>|</li>
                  <li><a href="..\iindex\index.html">Index</a>|</li>
                  <li><a href="..\contact\index.html">Contact</a></li>
                </ul>

        <p><a href="#" onclick="print();" title="Javascript needed for a Print">Print</a> | <a href="#top">Top</a>&uarr;</p>
        </div> <!-- Footer end -->

</div> <!-- Wrapper end -->

<p id="backlinks">&copy;IARCS 2012&ndash;2016</p>
<p id="backlinks"><a href="http://www.pestujemeweb.cz/">Pěstujeme web</a> | visit: <a href="http://www.junglegym.cz/" title="Skluzavky Jungle Gym">Skluzavky</a></p>

</body>
</html>
