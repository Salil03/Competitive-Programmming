<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>

<meta name="Description" content="">
<meta name="author" content="">
<meta name="keywords" content="">

<meta name="robots" content="all,follow">

<!-- CSS --> 
<link rel="stylesheet" href="styles\default.css" type="text/css" media="screen, projection, tv">
<link rel="stylesheet" href="styles\print.css" type="text/css" media="print">

<!-- Favicon -->
<link rel="shortcut icon" href="img\iarcslogo.png" type="image/x-icon">
</head>

<body id="top">
<div id="wrapper">

	<div class="header">
	<h1><span><a href="http://www.iarcs.org.in/inoi"><span id="color">Indian Computing Olympiad</span></a></span></h1>
	<p id="about">Training Material</p>

	<a href="#skip-menu" class="hidden">Skip menu</a> <!-- Skip menu -->
	<div id="menu-box">
	  <ul id="web">
	    <li><a href="..\contact\index.html">Contact</a></li>
	    <li><a href="..\iindex\index.html">Index</a></li>
	    <li><a href="..\problems\index.html">Problems</a></li>
	    <li><a class="active" id="first" href="index-1.html">Topics</a></li>
	    <li><a href="..\index-1.html">Home</a></li>
	  </ul>
	</div>

	</div> <!-- Header end -->

<hr class="noscreen">

<div id="skip-menu"></div>

<div class="page">
  <div class="col-r">
    <div class="col-r-in">

      <h2><a href="shortest-paths.html">Shortest paths</a></h2>

      <h3><span>All pairs shortest paths: the Floyd-Warshall algorithm</span></h3>

      <p>
	Here is another way to compute shortest paths.  We compute
      </p>

      <ul>
	<li>
	  shortestpath(s,t,i) : shortest path from s to t that
          uses at most i edges
	</li>
      </ul>

      <p>
	Initially
      </p>

      <ul>
	<li>
	  shortestpath(s,t,0)   = 0,        if s = t<br>
	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          infinity, otherwise</li>

	<li>
	  shortestpath(s,t,i+1) = <br>
	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min
	  (<br>
	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shortestpath (s,t,i),<br>
	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_{k} shortestpath(s,k,i) + W[k,t]<br>
	  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</li>
	
      </ul>

      <p>
	Note that the shortest path from s to t will never go
	through a loop, because we can remove the loop and get a
	shorter path.  Thus, we only need to find paths of length
	at most N-1.
      </p>

      <p>
	This is called the Floyd-Warshall algorithm.
      </p>

      <p>
	We can compute this by storing the values in a 3
	dimensional array SP. Assume the vertices are numbered
	[1,2,...,n]
      </p>

      <p>
	We maintain the value shortestpath(s,t,i) as  SP[s,t,i].
      </p>


      <pre>
      SP[s,t,0] = 0 if s = t, infinity otherwise

      for (i = 1; i < n; i++){
          for (t = 1; t <= n; t++){
              /*
                 SP[s,t,i] = min (SP[s,t,i-1],
                                  min SP[s,u,i]+W[u,t])
                                   u
              */
              SP[s,t,i] = SP[s,t,i-1];
              for (u = 1; u <= n; u++){
                  SP[s,t,i] = min(SP[s,t,i],SP[s,u,i-i]+W[u,t]);
              }
          }
      }
      </pre>

      <p>
	This algorithm takes time n<sup>3</sup> to compute SP[s,t,n-1].
	Note that to compute SP[s,t,i], we only need<br> SP[s,t,i-1],
	so we can make do with just two 2-dimensional arrays of
	size n&times;n that we use alternately, rather than a
	3-dimensional array of size n&times;n&times;n.
      <p>

      <p>
	<b>Claim:</b> Floyd-Warshall can compute shortest paths
	in situations that Dijkstra does not.
      </p>

      <p>
	Suppose we can have negative edge weights.  If we have
	cycles with a total negative weight, the notion of
	shortest path does not make sense because we can go
	around the negative cycle as many times as we want and
	reduce the overall weight.  So, let us permit negative
	edge weights, provided they do not induce negative
	cycles.
      <p>

	<ul>

	  <li>
	    Will Dijkstra's algorithm work in graphs with
	    negative edges?
	  </li>

	  <li>
	    How will Floyd-Warshall work if there are negative
	    edges?  How many iterations will it take?  (Note that
	    since there are no negative weight cycles, any cycle
	    we visit will have a positive weight and can hence be
	    eliminated from any shortest path.)
	  </li>

	</ul>

      <div id="video-material">
	<h3><span>Video material</span></h3>
      </div>

      <p>Video lectures on <em>shortest paths</em>,
	<a href="https://onlinecourses.nptel.ac.in/explorer">
	  NPTEL online course</a> on
        <a href="https://onlinecourses.nptel.ac.in/noc15_cs02/preview">
  	  Design and Analysis of Algorithms</a>

      <ul>
        <li> All pairs shortest paths: Floyd-Warshall algorithm
        (<a href="http://www.cmi.ac.in/~madhavan/nptel-algorithms-2015/week4/pdf/nptel-week4-module4-allpairs.pdf" target="_blank">Lecture slides</a>)<p>

        <iframe width="560" height="315" src="https://www.youtube.com/embed/_4CGMB5j_CQ" frameborder="0" allowfullscreen=""></iframe>

        <li> Single source shortest paths with negative edge weights, Bellman-Ford algorithm
        (<a href="http://www.cmi.ac.in/~madhavan/nptel-algorithms-2015/week4/pdf/nptel-week4-module3-bellman-ford.pdf" target="_blank">Lecture slides</a>)<p>

        <iframe width="560" height="315" src="https://www.youtube.com/embed/YbbGemzQ5ok" frameborder="0" allowfullscreen=""></iframe>

      </li></ul>

      <br><br>

    </div>
  </div> <!-- Right column end -->


    <hr class="noscreen">

  <div class="col-l">
    <div class="col-l-in">
      <h3>Basic topics</h3>
      <ul class="menu">
	<li><a href="introduction.html">Introduction</a></li>
	<li><a href="efficiency.html">Efficiency</a></li>
	<li><a href="binarysearch.html">Searching</a></li>
	<li><a href="sorting.html">Sorting</a></li>
	<li><a href="graphs.html">Basic Graph Algorithms</a></li>
	<li><a href="dp.html">Dynamic Programming</a></li>
	<li><a href="greedy.html">Greedy Algorithms</a></li>
	<li><a href="shortest-paths.html">Computing Shortest Paths</a></li>
	<li><a href="heaps.html">Heaps</a></li>
	<li><a href="permutations.html">Permutations</a></li>
	<li><a href="dags.html">Directed Acyclic Graphs</a></li>
	<li><a href="prefix-sums.html">Computing Prefix Sums</a></li>
	<li><a href="sliding-window.html">Sliding Window Algorithms</a></li>
      </ul>

      <h3>Advanced topics</h3>
      <ul class="menu">
	<li><a href="advanced-graph-algorithms.html">Advanced Graph Algorithms</a></li>
	<li><a href="dp-trees.html">Dynamic Programming on Trees</a></li>
	<li><a href="range-queries.html">Range Queries</a></li>
	<li><a href="network-flows.html">Network Flows</a></li>
	<li><a href="games.html">Games and Strategies</a></li>
	<li><a href="geometry.html">Geometry</a></li>
      </ul>


      <br>

    </div>
  </div> <!-- Left column end -->

  <div class="cleaner">&nbsp;</div>

        </div> <!-- Page end -->

        <div id="footer">
                <ul>
                  <li><a href="..\index-1.html">Home</a>|</li>
                  <li><a href="">Topics</a>|</li>
                  <li><a href="..\problems\index.html">Problems</a>|</li>
                  <li><a href="..\iindex\index.html">Index</a>|</li>
                  <li><a href="..\contact\index.html">Contact</a></li>
                </ul>

        <p><a href="#" onclick="print();" title="Javascript needed for a Print">Print</a> | <a href="#top">Top</a>&uarr;</p>
        </div> <!-- Footer end -->

</div> <!-- Wrapper end -->

<p id="backlinks">&copy;IARCS 2012&ndash;2016</p>
<p id="backlinks"><a href="http://www.pestujemeweb.cz/">Pěstujeme web</a> | visit: <a href="http://www.junglegym.cz/" title="Skluzavky Jungle Gym">Skluzavky</a></p>

</body>
</html>
