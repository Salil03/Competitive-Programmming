<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>

<meta name="Description" content="">
<meta name="author" content="">
<meta name="keywords" content="">

<meta name="robots" content="all,follow">

<!-- CSS --> 
<link rel="stylesheet" href="styles\default.css" type="text/css" media="screen, projection, tv">
<link rel="stylesheet" href="styles\print.css" type="text/css" media="print">

<!-- Favicon -->
<link rel="shortcut icon" href="img\iarcslogo.png" type="image/x-icon">
</head>

<body id="top">
<div id="wrapper">

	<div class="header">
	<h1><span><a href="http://www.iarcs.org.in/inoi"><span id="color">Indian Computing Olympiad</span></a></span></h1>
	<p id="about">Training Material</p>

	<a href="#skip-menu" class="hidden">Skip menu</a> <!-- Skip menu -->
	<div id="menu-box">
	  <ul id="web">
	    <li><a href="..\contact\index.html">Contact</a></li>
	    <li><a href="..\iindex\index.html">Index</a></li>
	    <li><a href="..\problems\index.html">Problems</a></li>
	    <li><a class="active" id="first" href="index-1.html">Topics</a></li>
	    <li><a href="..\index-1.html">Home</a></li>
	  </ul>
	</div>

	</div> <!-- Header end -->

<hr class="noscreen">

<div id="skip-menu"></div>

<div class="page">
  <div class="col-r">
    <div class="col-r-in">

      <h2><a href="graphs.html">Basic Graph Algorithms</a></h2>

      <h3><span>Breadth-first search</span></h3>

      <p>
	Here is the code for breadth-first search for a general
	graph, starting from some vertex v.
	</p>

      <pre>
       BFS(v){

         mark(v);
         add v at the end of the Queue;  /* Queue was empty */

         while the Queue is not empty{
           remove the vertex w at the head of the Queue;
           for each unmarked neighbour u of w{
             mark(u);
             add u to the end of the Queue;
           }
         }
       }
      </pre>

      <p>
	For instance, BFS(1) on the following graphs generates
	the queue
      </p>

      <p align="center">
	1, 2, 3, 4, 5, 8, 6, 7
      </p>

      <pre>
          1
         / \
        2---3
        |                   
        4---8
        |   |
        5   7
         \ /
          6
      </pre>

      <p>
	The order which the vertices are visited by BFS gives the
	shortest path.  How do we recover the length of the path?
	We can record the length of the shortest path to each
	vertex w when we add it to the queue.  This is just one
	more than the length of the shortest path to its parent.
      </p>

      <pre>
       BFS(v){

         mark(v);
         length(v) = 1;
         add v at the end of the Queue;  /* Queue was empty */

         while the Queue is not empty{
           remove the vertex w at the head of the Queue;
           for each unmarked neighbour u of w{
             mark(u);
             length(u) = length(w)+1;
             add u to the end of the Queue;
           }
         }
       }
      </pre>

      <p>
	To actually recover the path, once again, we can also
	record parent(u)=w when we explore w and add u to the
	queue.
      </p>

      <pre>
       BFS(v){

         mark(v);
         length(v) = 1;
         add v at the end of the Queue;  /* Queue was empty */

         while the Queue is not empty{
           remove the vertex w at the head of the Queue;
           for each unmarked neighbour u of w{
             mark(u);
             length(u) = length(w)+1;
             parent(u) = w;
             add u to the end of the Queue;
           }
         }
       }
      </pre>

      <div id="graphs-bfs-tree">
      <h3><span>BFS tree</span></h3>
	<p>
	  When we explore a graph using breadth first tree, we
	  can represent the visited nodes as a tree, called the
	  BFS tree.
	</p>

	<p>
	  Consider the following graph.
	</p>

	<pre>
                b
               / \
              /   \
             a     c
              \   /|\
               \ / | \
                d--+--e
               / \ |  |
              /   \|  |
             i-----j  |
                   |  f
                   | / \
                   |/   \
                   g-----h
	</pre>

	<p>
	  Suppose we start BFS at b
	</p>

	<ul>
	  <li>From b, we visit a,c (level 1)    &mdash; queue is {a,c}</li>
	  <li>From a, we visit d (level 2)      &mdash; queue is {c,d}</li>
	  <li>From c, we visit j,e (level 2)    &mdash; queue is {d,j,e}</li>
	  <li>From d, we visit i (level 3)      &mdash; queue is {j,e,i}</li>
	  <li>From j, we visit g (level 3)      &mdash; queue is {e,i,g}</li>
	  <li>From e, we visit f (level 3)      &mdash; queue is {i,g,f}</li>
	  <li>From i, no unmarked neighbours    &mdash; queue is {g,f}</li>
	  <li>From g, we visit h (level 4)      &mdash; queue is {f,h}</li>
	  <li>From f, no unmarked neighbours    &mdash; queue is {h}</li>
	  <li>From h, no unmarked neighbours    &mdash; queue is {}</li>
	  <li>Empty queue, so we stop</li>
	</ul>

	<p>
	  If draw the vertices that we visit in BFS level by
	  level, we get the following tree, called the BFS tree.
	</p>

	<pre>
               ---b ---
              /         \
             a            c
             |          /   \
             d        j       e
             |        |       |
             i        g       f
                      |
                      h
	</pre>

	<p>
	  The edges in this tree come from the graph.  There are
	  some edges in the graph that do not appear in this
	  tree.  In this case, they are {(c,d), (d,e), (d,j),
	  (f,g), (f,h)}.  If we add these edges to this tree we
	  get a picture like this.
	</p>

	<pre>
               --- b ---
              /          \
             a   ......... c
             | .         /   \
             d ....... j       e...
             | .       |       |   .
             i  .      g ..... f   .
                 .     |       .   .
                  .    h .......   .
                   .               .
                    ................
	</pre>

	<p>
	  In this figure, we refer to the original edges (---) as tree
	  edges and the new edges (..., not used in the tree) as cross
	  edges.
	</p>	

	<p>
	  Note that cross edges either connect at same level or adjacent levels.
	  Cross edges cannot cross two levels. (Why?)
	</p>

      <div id="video-material">
        <h3><span>Video material</span></h3>
      </div>

      <p>Video lecture on <em>Breadth first search</em>,
	<a href="https://onlinecourses.nptel.ac.in/explorer">
	  NPTEL online course</a> on
        <a href="https://onlinecourses.nptel.ac.in/noc15_cs02/preview">
  	  Design and Analysis of Algorithms</a>
        (<a href="http://www.cmi.ac.in/~madhavan/nptel-algorithms-2015/week3/pdf/nptel-week3-module3-bfs.pdf" target="_blank">Lecture slides</a>)</p>

        <iframe width="560" height="315" src="https://www.youtube.com/embed/ahXszIXr1NE" frameborder="0" allowfullscreen=""></iframe>

        <br><br>
	
      </div>

    </div>
  </div> <!-- Right column end -->

   <hr class="noscreen">

  <div class="col-l">
    <div class="col-l-in">
      <h3>Basic topics</h3>
      <ul class="menu">
	<li><a href="introduction.html">Introduction</a></li>
	<li><a href="efficiency.html">Efficiency</a></li>
	<li><a href="binarysearch.html">Searching</a></li>
	<li><a href="sorting.html">Sorting</a></li>
	<li><a href="graphs.html">Basic Graph Algorithms</a></li>
	<li><a href="dp.html">Dynamic Programming</a></li>
	<li><a href="greedy.html">Greedy Algorithms</a></li>
	<li><a href="shortest-paths.html">Computing Shortest Paths</a></li>
	<li><a href="heaps.html">Heaps</a></li>
	<li><a href="permutations.html">Permutations</a></li>
	<li><a href="dags.html">Directed Acyclic Graphs</a></li>
	<li><a href="prefix-sums.html">Computing Prefix Sums</a></li>
	<li><a href="sliding-window.html">Sliding Window Algorithms</a></li>
      </ul>

      <h3>Advanced topics</h3>
      <ul class="menu">
	<li><a href="advanced-graph-algorithms.html">Advanced Graph Algorithms</a></li>
	<li><a href="dp-trees.html">Dynamic Programming on Trees</a></li>
	<li><a href="range-queries.html">Range Queries</a></li>
	<li><a href="network-flows.html">Network Flows</a></li>
	<li><a href="games.html">Games and Strategies</a></li>
	<li><a href="geometry.html">Geometry</a></li>
      </ul>


      <br>

    </div>
  </div> <!-- Left column end -->

 <div class="cleaner">&nbsp;</div>

        </div> <!-- Page end -->

        <div id="footer">
                <ul>
                  <li><a href="..\index-1.html">Home</a>|</li>
                  <li><a href="">Topics</a>|</li>
                  <li><a href="..\problems\index.html">Problems</a>|</li>
                  <li><a href="..\iindex\index.html">Index</a>|</li>
                  <li><a href="..\contact\index.html">Contact</a></li>
                </ul>

        <p><a href="#" onclick="print();" title="Javascript needed for a Print">Print</a> | <a href="#top">Top</a>&uarr;</p>
        </div> <!-- Footer end -->

</div> <!-- Wrapper end -->

<p id="backlinks">&copy;IARCS 2012&ndash;2016</p>
<p id="backlinks"><a href="http://www.pestujemeweb.cz/">Pěstujeme web</a> | visit: <a href="http://www.junglegym.cz/" title="Skluzavky Jungle Gym">Skluzavky</a></p>

</body>
</html>
