<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>

<meta name="Description" content="">
<meta name="author" content="">
<meta name="keywords" content="">

<meta name="robots" content="all,follow">

<!-- CSS --> 
<link rel="stylesheet" href="styles\default.css" type="text/css" media="screen, projection, tv">
<link rel="stylesheet" href="styles\print.css" type="text/css" media="print">

<!-- Favicon -->
<link rel="shortcut icon" href="img\iarcslogo.png" type="image/x-icon">
</head>

<body id="top">
<div id="wrapper">

	<div class="header">
	<h1><span><a href="http://www.iarcs.org.in/inoi"><span id="color">Indian Computing Olympiad</span></a></span></h1>
	<p id="about">Training Material</p>

	<a href="#skip-menu" class="hidden">Skip menu</a> <!-- Skip menu -->
	<div id="menu-box">
	  <ul id="web">
	    <li><a href="..\contact\index.html">Contact</a></li>
	    <li><a href="..\iindex\index.html">Index</a></li>
	    <li><a class="active" id="first" href="index-1.html">Problems</a></li>
	    <li><a href="../topics">Topics</a></li>
	    <li><a href="..\index-1.html">Home</a></li>
	  </ul>
	</div>

	</div> <!-- Header end -->

<hr class="noscreen">

<div id="skip-menu"></div>

<div class="page">
  <div class="col-r">
    <div class="col-r-in">

      <h2>
        <a href="..\topics\permutations.html">Generating permutations</a>&rarr;Depot (IOI 2001)
      </h2>

      <p>
	A storage depot consists of a 2 dimensional array of
	slots.  Each object to be stored in the depot has a
	unique serial number.  When an object with sequence
	number K arrives, it is stored according to the following
	pair of rules.
      </p>

      <ol>

	<li>
	  If K is bigger than the sequence numbers in row 1, add
	  K at the end of row 1.
	</li>

	<li>
	  Otherwise, find the smallest sequence number bigger
	  than K in row 1, say L.  Replace object L by K and
	  insert L into row 2 using the same pair of rules.
	</li>

      </ol>

      <p>
	Problem: Given the final configuration of a depot,
	construct all input sequences that could have given rise
	to the depot.
      </p>

      <div id="solution">
	<h2>Solution</h2>
      </div>

      <p>
	Assume that the values in the depot are 1..N.  In
	general, the number of compatible input configurations is
	exponential in N.
      </p>

      <p>
	A naive solution would be to enumerate all permutations
	of 1..N, apply the depot rules and see if the resulting
	depot matches the one given.  This is possible within the
	time limits for N upto 7, possibly 8.
      </p>

      <p>
	For larger inputs (upto 13), use a recursive procedure to
	work backwards from the final depot.  Notice that at each
	stage of constructing a depot, the last element to move
	settles down at the end of a row.  It should also be a
	"corner" element---that is, the row below should be
	strictly shorter in length.
      </p>

      <p>
	Thus, for a given depot, for each row we look at the last
	element and, if it is a corner, "undo" the sequence of
	moves that brought it there, thus generating a possible
	last element of the input sequence together with the
	previous configuration of the depot.  We recursively
	explore all these previous configurations.  When the
	depot becomes empty, we would have built up a possible
	input sequence.
      </p>

      <p>
	Example:
      </p>

      <pre>
       Input sequence :  3 2 6 4 1 5

       Step  :   1            2          3        4      5      6

       Residual
       Input:    2 6 4 1 5    6 4 1 5    4 1 5    1 5    5      Empty

       Depot:    3            2          2 6      2 4    1 4    1 4 5
                              3          3        3 6    2 6    2 6
                                                                3
      </pre>

      <p>
	Corner elements are {3,6,5}.  Suppose we undo the 3.  The
	3 displaces the 2 in the previous row (largest element in
	that row smaller than 3), which in turn displaces the 1
	in the first row.  This leaves us with
      </p>

      <pre>
            2 4 5         Partial input sequence:  1
            3 6

       Corner elements are {6,5}.  If we undo the 6, we get

            2 4 6         Partial input sequence:  5 1
            3

       Corner elements are {3,6}.  Undoing 6 again, we get

            2 4           Partial input sequence:  6 5 1
            3

       Corner elements are {3,4}.  Undoing 3, we get

            3 4           Partial input sequence:  2 6 5 1
      </pre>

      <p>
	Now we have to undo 4, then 3, yielding a candidate input
	sequence 3 4 2 6 5 1.  Verify that this does indeed
	generate the same depot.
      </p>

      <pre>
       Input sequence :  3 4 2 6 5 1

       Resulting depot:

       Step  :   1            2          3        4       5        6

       Residual
       Input:    4 2 6 5 1    2 6 5 1    6 5 1    5 1     1        Empty

       Depot:    3            3 4        2 4      2 4 6   2 4 5    1 4 5
                                         3        3       3 6      2 6
                                                                   3
      </pre>

      <h3><span>An aside:</span></h3>

      <p>
	Suppose, while constructing a depot, we also keep track
	of the order in which the squares are filled, which
	yields a second "depot" with the same shape.
      </p>

      <pre>
       Input sequence :  3 4 2 6 5 1

       Resulting depot:

       Step  :   1            2          3        4       5        6

       Residual
       Input:    4 2 6 5 1    2 6 5 1    6 5 1    5 1     1        Empty

       Depot1:   3            3 4        2 4      2 4 6   2 4 5    1 4 5
                                         3        3       3 6      2 6
                                                                   3

       Depot2:   1            1 2        1 2      1 2 4   1 2 4    1 2 4
                                         3        3       3 5      3 5
                                                                   6
      </pre>

      <p>
	Since the second depot tells us the order in which the
	depot was filled, we know in which order we should undo
	the moves, which deterministically gets us the input
	sequence that generated this pair of depots.
      </p>

      <p>
	It turns out that each permutation generates a unique
	pair of depots and vice versa, so the set of permutations
	of 1..n is in 1-1 correspondence with the set of pairs of
	valid depots of the same shape over 1..n.
      </p>

      <hr class="noscreen">
      <br>


    </div>
  </div> <!-- Right column end -->


    <hr class="noscreen">

  <div class="col-l">
    <div class="col-l-in">
      <h3>Problems related to</h3>
      <ul class="menu">
        <li><a href="index-1.html#binarysearch">Searching</a></li>
        <li><a href="index-1.html#sorting">Sorting</a></li>
        <li><a href="index-1.html#graphs">Basic Graph Algorithms</a></li>
        <li><a href="index-1.html#dp">Dynamic Programming</a></li>
        <li><a href="index-1.html#greedy">Greedy Algorithms</a></li>
        <li><a href="">Computing Shortest Paths</a></li>
        <li><a href="index-1.html#heaps">Heaps</a></li>
        <li><a href="index-1.html#permutations">Permutations</a></li>
        <li><a href="index-1.html#dags">Directed Acyclic Graphs</a></li>
        <li><a href="index-1.html#prefix-sums">Computing Prefix Sums</a></li>
        <li><a href="index-1.html#sliding-window">Sliding Window Algorithms</a></li>
        <li><a href="index-1.html#advanced-graph-algorithms">Advanced Graph Algorithms</a></li>
        <li><a href="index-1.html#dp-trees">Dynamic Programming on Trees</a></li>
        <li><a href="index-1.html#range-queries">Range Queries</a></li>
        <li><a href="index-1.html#network-flows">Network Flows</a></li>
        <li><a href="index-1.html">Games and Strategies</a></li>
        <li><a href="index-1.html#geometry">Geometry</a></li>
      </ul>


      <br>

    </div>
  </div> <!-- Left column end -->

  <div class="cleaner">&nbsp;</div>

        </div> <!-- Page end -->

        <div id="footer">
                <ul>
                  <li><a href="..\index-1.html">Home</a>|</li>
                  <li><a href="../topics">Topics</a>|</li>
                  <li><a href="">Problems</a>|</li>
                  <li><a href="..\iindex\index.html">Index</a>|</li>
                  <li><a href="..\contact\index.html">Contact</a></li>
                </ul>

        <p><a href="#" onclick="print();" title="Javascript needed for a Print">Print</a> | <a href="#top">Top</a>&uarr;</p>
        </div> <!-- Footer end -->

</div> <!-- Wrapper end -->

<p id="backlinks">&copy;IARCS 2012&ndash;2016</p>
<p id="backlinks"><a href="http://www.pestujemeweb.cz/">Pěstujeme web</a> | visit: <a href="http://www.junglegym.cz/" title="Skluzavky Jungle Gym">Skluzavky</a></p>

</body>
</html>
