<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>

<meta name="Description" content="">
<meta name="author" content="">
<meta name="keywords" content="">

<meta name="robots" content="all,follow">

<!-- CSS --> 
<link rel="stylesheet" href="styles\default.css" type="text/css" media="screen, projection, tv">
<link rel="stylesheet" href="styles\print.css" type="text/css" media="print">

<!-- Favicon -->
<link rel="shortcut icon" href="img\iarcslogo.png" type="image/x-icon">
</head>

<body id="top">
<div id="wrapper">

	<div class="header">
	<h1><span><a href="http://www.iarcs.org.in/inoi"><span id="color">Indian Computing Olympiad</span></a></span></h1>
	<p id="about">Training Material</p>

	<a href="#skip-menu" class="hidden">Skip menu</a> <!-- Skip menu -->
	<div id="menu-box">
	  <ul id="web">
	    <li><a href="..\contact\index.html">Contact</a></li>
	    <li><a href="..\iindex\index.html">Index</a></li>
	    <li><a class="active" id="first" href="index-1.html">Problems</a></li>
	    <li><a href="../topics">Topics</a></li>
	    <li><a href="..\index-1.html">Home</a></li>
	  </ul>
	</div>

	</div> <!-- Header end -->

<hr class="noscreen">

<div id="skip-menu"></div>

<div class="page">
  <div class="col-r">
    <div class="col-r-in">

      <h2>
	<a href="..\topics\dp.html">Dynamic Programming</a>&rarr;DNA (APIO 2008)
      </h2>

      <p>
	One interesting use of computer is to analyze biological data
	such as DNA sequences. Biologically, a strand of DNA is a chain
	of nucleotides Adenine, Cytosine, Guanine, and Thymine. The four
	nucleotides are represented by characters A, C, G, and T,
	respectively. Thus, a strand of DNA can be represented by a
	string of these four characters. We call such a string a DNA
	sequence.
      </p>

      <p>
	It is possible that the biologists cannot determine some
	nucleotides in a DNA strand. In such a case, the
	character N is used to represent an unknown nucleotides
	in the DNA sequence of the strand. In other words, N is a
	wildcard character for any one character among A, C, G or
	T. We call a DNA sequence with one or more character N an
	incomplete sequence ; otherwise, it is called a complete
	sequence. A complete sequence is said to agree with an
	incomplete sequence if it is a result of substituting
	each N in the incomplete sequence with one of the four
	nucleotides. For example, ACCCT agrees with ACNNT, but
	AGGAT does not.
      </p>

      <p>
	Researchers often order the four nucleotides the way we
	order the English alphabets: A comes before C, C comes
	before G, G comes before T. A DNA sequence is classified
	as form-1 if every nucleotide in it is the same as or
	comes before the nucleotides immediately to its
	right. For example, AACCGT is form-1, but AACGTC is not.
      </p>

      <p>
	In general, a sequence is form-j , for j&gt;1, if it is a
	form-(j-1) or it is a concatenation of a form-(j-1)
	sequence and a form-1 sequence. For example, AACCC,
	ACACC, and ACACA are form-3, but GCACAC and ACACACA are
	not.
      </p>

      <p>
	Again, researchers order DNA sequences lexicographically
	the way we order words in a dictionary.  As such, the
	first form-3 sequence of length 5 is AAAAA, and the last
	is TTTTT. As another example, consider the incomplete
	sequence ACANNCNNG. The first seven form-3 sequences that
	agree with it are:
      </p>

      <pre>
	ACAAACAAG
	ACAAACACG
	ACAAACAGG
	ACAAACCAG
	ACAAACCCG
	ACAAACCGG
	ACAAACCTG
      </pre>

      <p>
	Given an incomplete sequence of length M, and two values
	K and R, the task to find the Rth form-K sequence that
	agrees with the given incomplete sequence.
      </p>

      <p>
	Here M&le;50000, K&le;10, R&le;2<sup>12</sup>.
      </p>

      <div id="solution">
	<h2>Solution</h2>
      </div>
      
      <p>
	A form-K sequence can be decomposed into at most K
	blocks, where block has letters in non-decreasing order.
      </p>

      <p>
	To start with let us write a recurrence to compute the number of
	form-K sequences of a given length, without any constraints.
      </p>
      
      <p>
	For 1&le;i&le;m, 1&le;j&le;K, X in {A,C,G,T}, let
	f(i,j,X) denote the number of form-K sequences from
	positions i to M starting with X.
      </p>

      <p>
	There are two cases to consider:
      </p>

      <ul>

	<li>
	  The letter at position i+1 is strictly smaller than X.
	  If so, a new block starts at i+1 so we need to consider
	  form-(j-1) sequences from i+1
	</li>

	<li>
	  The letter at position i+1 is greater than or equal to
	  X.  If so, the block at i continues into i+1, so we
	  need to consider form-j sequences from i+1.
	</li>

      </ul>

      <p>
	This gives us the recurrence
      </p>

      <ul>
	<li>
	  f(i,j,X) = sum_{Y&lt;X} f(i+1,j-1,Y) + sum_{Y&ge;X}
	  f(i+1,j,Y)
	</li>                              
      </ul>

      <p>
	Now, how do we count the number of form-K sequences
	compatible with a given pattern?  The pattern fixes
	values for certain positions.  Suppose the p[i], the ith
	position in the pattern, is 'A'.  Then, for all j
      </p>

      <ul>
	<li> f(i,j,X) = 0 for X not equal to 'A'</li>
      </ul>

      <p>
	In this way, we fill in 0's for all values f(i,j,X) such
	that p[i] is not N and p[i] is not equal to X.  We then
	process the recurrence as before to get the total number
	of form-K sequences compatible with the pattern.
      </p>

      <p>
	Now, how do we find the Rth such sequence?
      </p>

      <p>
	The total number of form-K sequences is, in general, the
	sum
      </p>

      <p align="center">
	f(1,j,'A') + f(1,j,'C') + f(1,j,'G') + f(1,j,'T')
      </p>

      <p>
	Let these values be n_A, n_C, n_G and n_T, respectively.
	Clearly, the first n_A sequences in lexicographic order
	start with A, the next n_C sequence start with C,
	&hellip;.  If R&le;n_A, we know the first letter is A.
	If n_A&lt;R&le;n_A + n_C, the first letter is C, and so
	on.
      </p>

      <p>
	Suppose that n_A&lt;R&le;n_A+n_C.  This fixes the first
	letter to be C and we now look for the sequence with
	index R_1 = (R - n_A) starting with C.
      </p>

      <p>
	As before, we know that n_C is the sum of four terms, n_CA, n_CC, n_CG and
	n_CT.  Again, by checking if R1&le;n_CA or
	n_CA&lt;R1&le;n_CA+n_CC, &hellip; we
	can determine the second letter of the sequence.
      </p>

      <p>
	This yields a new value R2 with which we can compute the
	third letter, and so on.
      </p>

    </div>
  </div> <!-- Right column end -->


    <hr class="noscreen">

  <div class="col-l">
    <div class="col-l-in">
      <h3>Problems related to</h3>
      <ul class="menu">
        <li><a href="index-1.html#binarysearch">Searching</a></li>
        <li><a href="index-1.html#sorting">Sorting</a></li>
        <li><a href="index-1.html#graphs">Basic Graph Algorithms</a></li>
        <li><a href="index-1.html#dp">Dynamic Programming</a></li>
        <li><a href="index-1.html#greedy">Greedy Algorithms</a></li>
        <li><a href="">Computing Shortest Paths</a></li>
        <li><a href="index-1.html#heaps">Heaps</a></li>
        <li><a href="index-1.html#permutations">Permutations</a></li>
        <li><a href="index-1.html#dags">Directed Acyclic Graphs</a></li>
        <li><a href="index-1.html#prefix-sums">Computing Prefix Sums</a></li>
        <li><a href="index-1.html#sliding-window">Sliding Window Algorithms</a></li>
        <li><a href="index-1.html#advanced-graph-algorithms">Advanced Graph Algorithms</a></li>
        <li><a href="index-1.html#dp-trees">Dynamic Programming on Trees</a></li>
        <li><a href="index-1.html#range-queries">Range Queries</a></li>
        <li><a href="index-1.html#network-flows">Network Flows</a></li>
        <li><a href="index-1.html">Games and Strategies</a></li>
        <li><a href="index-1.html#geometry">Geometry</a></li>
      </ul>


      <br>

    </div>
  </div> <!-- Left column end -->

  <div class="cleaner">&nbsp;</div>

        </div> <!-- Page end -->

        <div id="footer">
                <ul>
                  <li><a href="..\index-1.html">Home</a>|</li>
                  <li><a href="../topics">Topics</a>|</li>
                  <li><a href="">Problems</a>|</li>
                  <li><a href="..\iindex\index.html">Index</a>|</li>
                  <li><a href="..\contact\index.html">Contact</a></li>
                </ul>

        <p><a href="#" onclick="print();" title="Javascript needed for a Print">Print</a> | <a href="#top">Top</a>&uarr;</p>
        </div> <!-- Footer end -->

</div> <!-- Wrapper end -->

<p id="backlinks">&copy;IARCS 2012&ndash;2016</p>
<p id="backlinks"><a href="http://www.pestujemeweb.cz/">Pěstujeme web</a> | visit: <a href="http://www.junglegym.cz/" title="Skluzavky Jungle Gym">Skluzavky</a></p>

</body>
</html>
