<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>

<meta name="Description" content="">
<meta name="author" content="">
<meta name="keywords" content="">

<meta name="robots" content="all,follow">

<!-- CSS --> 
<link rel="stylesheet" href="styles\default.css" type="text/css" media="screen, projection, tv">
<link rel="stylesheet" href="styles\print.css" type="text/css" media="print">

<!-- Favicon -->
<link rel="shortcut icon" href="img\iarcslogo.png" type="image/x-icon">
</head>

<body id="top">
<div id="wrapper">

	<div class="header">
	<h1><span><a href="http://www.iarcs.org.in/inoi"><span id="color">Indian Computing Olympiad</span></a></span></h1>
	<p id="about">Training Material</p>

	<a href="#skip-menu" class="hidden">Skip menu</a> <!-- Skip menu -->
	<div id="menu-box">
	  <ul id="web">
	    <li><a href="..\contact\index.html">Contact</a></li>
	    <li><a href="..\iindex\index.html">Index</a></li>
	    <li><a class="active" id="first" href="index-1.html">Problems</a></li>
	    <li><a href="../topics">Topics</a></li>
	    <li><a href="..\index-1.html">Home</a></li>
	  </ul>
	</div>

	</div> <!-- Header end -->

<hr class="noscreen">

<div id="skip-menu"></div>

<div class="page">
  <div class="col-r">
    <div class="col-r-in">

      <h2>
        <a href="..\topics\greedy.html">Greedy Algorithms</a>&rarr;Teleporters (IOI 2008)
      </h2>

      <p>
	You are participating in a competition that involves
	crossing Egypt from west to east along a straight line
	segment. Initially you are located at the westmost point
	of the segment. It is a rule of the competition that you
	must always move along the segment, and always eastward.
      </p>

      <p>
	There are N teleporters on the segment. A teleporter has
	two endpoints. Whenever you reach one of the endpoints,
	the teleporter immediately teleports you to the other
	endpoint. (Note that, depending on which endpoint of the
	teleporter you reach, teleportation can transport you
	either eastward or westward of your current position.)
	After being teleported, you must continue to move
	eastward along the segment; you can never avoid a
	teleporter endpoint that is on your way. There will never
	be two teleporter endpoints at the same
	position. Endpoints will be strictly between the start
	and the end of the segment.
      </p>

      <p>
	Every time you get teleported, you earn 1 point. The
	objective of the competition is to earn as many points as
	possible. In order to maximize the points you earn, you
	are allowed to add up to M new teleporters to the segment
	before you start your journey.  You also earn points for
	using the new teleporters.
      </p>

      <p>
	You can set the endpoints of the new teleporters wherever
	you want (even at non‐integer coordinates) as long as
	they do not occupy a position already occupied by another
	endpoint. That is, the positions of the endpoints of all
	teleporters must be unique. Also, endpoints of new
	teleporters must lie strictly between the start and the
	end of the segment.
      </p>

      <p>
	Note that it is guaranteed that no matter how you add the
	teleporters, you can always reach the end of the segment.
      </p>

      <p>
	Constraints:
      </p>

      <ul>
	<li>  1&le;N&le;10<sup>6</sup></li>
	<li>  1&le;M&le;10<sup>6</sup></li>
	<li>  Distance between endpoints of segment&le;2&times;10<sup>6</sup></li>
      </ul>

      <div id="solution">
	<h2>Solution</h2>
      </div>

      <p>
	It helps to analyze why the last statement is true ---
	why will you always reach the end of the segment?
      </p>

      <p>
	Construct a directed graph where the vertices represent
	the segments between teleporters.
      </p>

      <ul>
	<li> From each segment (except the last one) there is
	  exactly one outgoing edge: walk to the right endpoint
	  of the segment and see where the teleporter takes
	  you.</li>

	<li> Each segment (except the first one) has exactly one
	  incoming edge: the other end point of the teleporter at
	  the left end of the segment.</li>

      </ul>

      <p>
	Thus, the first segment has an outgoing edge but no
	incoming edge.  As we walk, we can never close a cycle
	(because for each segment we have seen, we have already
	traversed its unique incoming edge), so we eventually
	trace out a path and exit via the last segment.
      </p>

      <p>
	The nodes that are not visited on this path form
	(disjoint) cycles.
      </p>

      <p>
	In other words, we start with a graph that consists of
	one path and several cycles.  What happens when we add a
	teleporter?
      </p>

      <ol>

	<li>A teleporter connects two segments across disjoint
	  components.<br><br>

	  The corresponding segments in each cycle get split (one
	  node becomes two) and we end up with a connection that
	  forms a single larger cycle.<br><br>

	  Therefore:</li>

	<ul>

	  <li> If we connect a path to a cycle, we get a longer
	    path.</li>

	  <li> If we connect a cycle to a cycle, we get a longer
	    cycle.</li>

	</ul>

	<li> A teleporter connects two segments in the same components.<br><br>

	  This splits the cycle into two disjoint cycles.  This
	  is not useful!</li>

	<li> A teleporter is connected within a segment.<br><br>

	  This expands the current cycle with one edge and spawns
	  a separate cycle with a single node (self loop).</li>

      </ol>

      <p><b>Greedy algorithm:</b></p>

      <ul>

	<li> Find connected components of the graph and identify
	  the path and all the cycles.</li>

	<li> Sort the cycles in descending order of size.</li>

	<li> Connect the path to the largest cycle &mdash;
	  expands the path.</li>

	<li> Keep adding cycles in descending order of size till
	  no cycles remain.  At this stage, the entire graph is a
	  single path.</li>

	<li> If you have not yet exhausted the M additional
	  teleporters edges, alternately apply case 3 and case 1
	  &mdash; i.e., expand the path by one edge and spawn off
	  a trivial cycle, then merge the trivial cycle back to
	  form a longer path.</li>

      </ul>

      <p>
	All these operations can be done in linear time.  (Note:
	you don't have to actually do the operations above, just
	compute how the sizes change as a result of performing
	these operations!)
      </p>

      <p>
	What about sorting?  Since we know that the number is
	bounded by 10<sup>6</sup>, we can do a counting sort.
	Maintain an array A of size 10<sup>6</sup> and record a
	count of how many times each value appears (when you read
	a value i, increment A[i]).  After scanning the input,
	scan A and print out i A[i] times.
      </p>

      <hr class="noscreen">
      <br>


    </div>
  </div> <!-- Right column end -->


    <hr class="noscreen">

  <div class="col-l">
    <div class="col-l-in">
      <h3>Problems related to</h3>
      <ul class="menu">
        <li><a href="index-1.html#binarysearch">Searching</a></li>
        <li><a href="index-1.html#sorting">Sorting</a></li>
        <li><a href="index-1.html#graphs">Basic Graph Algorithms</a></li>
        <li><a href="index-1.html#dp">Dynamic Programming</a></li>
        <li><a href="index-1.html#greedy">Greedy Algorithms</a></li>
        <li><a href="">Computing Shortest Paths</a></li>
        <li><a href="index-1.html#heaps">Heaps</a></li>
        <li><a href="index-1.html#permutations">Permutations</a></li>
        <li><a href="index-1.html#dags">Directed Acyclic Graphs</a></li>
        <li><a href="index-1.html#prefix-sums">Computing Prefix Sums</a></li>
        <li><a href="index-1.html#sliding-window">Sliding Window Algorithms</a></li>
        <li><a href="index-1.html#advanced-graph-algorithms">Advanced Graph Algorithms</a></li>
        <li><a href="index-1.html#dp-trees">Dynamic Programming on Trees</a></li>
        <li><a href="index-1.html#range-queries">Range Queries</a></li>
        <li><a href="index-1.html#network-flows">Network Flows</a></li>
        <li><a href="index-1.html">Games and Strategies</a></li>
        <li><a href="index-1.html#geometry">Geometry</a></li>
      </ul>


      <br>

    </div>
  </div> <!-- Left column end -->

  <div class="cleaner">&nbsp;</div>

        </div> <!-- Page end -->

        <div id="footer">
                <ul>
                  <li><a href="..\index-1.html">Home</a>|</li>
                  <li><a href="../topics">Topics</a>|</li>
                  <li><a href="">Problems</a>|</li>
                  <li><a href="..\iindex\index.html">Index</a>|</li>
                  <li><a href="..\contact\index.html">Contact</a></li>
                </ul>

        <p><a href="#" onclick="print();" title="Javascript needed for a Print">Print</a> | <a href="#top">Top</a>&uarr;</p>
        </div> <!-- Footer end -->

</div> <!-- Wrapper end -->

<p id="backlinks">&copy;IARCS 2012&ndash;2016</p>
<p id="backlinks"><a href="http://www.pestujemeweb.cz/">Pěstujeme web</a> | visit: <a href="http://www.junglegym.cz/" title="Skluzavky Jungle Gym">Skluzavky</a></p>

</body>
</html>
