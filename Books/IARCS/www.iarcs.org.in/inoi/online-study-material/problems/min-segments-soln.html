<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>

<meta name="Description" content="">
<meta name="author" content="">
<meta name="keywords" content="">

<meta name="robots" content="all,follow">

<!-- CSS --> 
<link rel="stylesheet" href="styles\default.css" type="text/css" media="screen, projection, tv">
<link rel="stylesheet" href="styles\print.css" type="text/css" media="print">

<!-- Favicon -->
<link rel="shortcut icon" href="img\iarcslogo.png" type="image/x-icon">
</head>

<body id="top">
<div id="wrapper">

	<div class="header">
	<h1><span><a href="http://www.iarcs.org.in/inoi"><span id="color">Indian Computing Olympiad</span></a></span></h1>
	<p id="about">Training Material</p>

	<a href="#skip-menu" class="hidden">Skip menu</a> <!-- Skip menu -->
	<div id="menu-box">
	  <ul id="web">
	    <li><a href="..\contact\index.html">Contact</a></li>
	    <li><a href="..\iindex\index.html">Index</a></li>
	    <li><a class="active" id="first" href="index-1.html">Problems</a></li>
	    <li><a href="../topics">Topics</a></li>
	    <li><a href="..\index-1.html">Home</a></li>
	  </ul>
	</div>

	</div> <!-- Header end -->

<hr class="noscreen">

<div id="skip-menu"></div>

<div class="page">
  <div class="col-r">
    <div class="col-r-in">

      <h2>
        <a href="..\topics\sliding-window.html">Sliding Window Algorithms</a>&rarr;Min Segments
      </h2>

      <p>
	You are given a sequence of N integers x1, x2, &hellip;,
	xN, where N can be as large as 10<sup>6</sup>.  You are
	also given an interval length M, where M can be as large
	as 10<sup>5</sup>.  The goal is to report the minimum of
	every segment of M numbers in the list.
      </p>

      <p>
	In other words, the output should be
      </p>

      <ul>
	<li> min (x1,x2,...,xM)
	<li> min (x2,...,xM,xM+1)
	<li> min (x3,...,xM+1,xM+2)
	<li> &hellip;
	<li> min (x(N-M+1),...,xN-1,xN)
      </li></ul>

      <p>
	If we compute the minimum explicitly for each M segment
	of the input, we end up doing about O(NM) work, which is
	too much given the limits for each N and M.
      </p>

      <p>
	Can we do better?
      </p>

      <div id="solution">
        <h2>Solution</h2>
      </div>


      <p>
	Break up the sequence into segments of length M.
      </p>

      <p>
	For each segment y1 y2 &hellip; yi &hellip: yM, compute
	and store for each yi the two quantities
	min(y1,y2,&hellip;,yi) and min(yi,yi+1,&hellip;,yM).
	This can be done in two linear scans of y1,y2,hellip;,yM,
	one from left to right and one from right to left.
      </p>

      <p>
	Now, if we ask for the minimum of some arbitrary interval of length M, it
	will in general span across two of the fixed intervals for which we have
	precomputed the values above.
      </p>

      <pre>
      y1 y2 ... yi-1 yi ... yM  z1 z2 ... zi-1 zi ... zM
                     |                      |
                     <---------------------->
      </pre>

      <p>
	We can compute min(yi,...,yM,z1,...,zi-1) from the
	precomputed values for these two intervals as
	min(min(yi...,yM), min(z1,...,zi-1)).
      </p>

      <p>
	Thus, in one scan, we can use the precomputed values to
	compute the minimum for all values.
      </p>

      <p>
	How much time does the precomputation take?  We have to
	precompute values for N/M intervals.  Each interval
	requires O(M) work, so overall we take about O(N) time
	for precomputation.
      </p>

      <p>
	The final solution then takes another O(N) scan of the sequence with the
	precomputed values.
      </p>

      <p>
	Notice that this technique can be applied to any function that is
	associative&emdash;e.g., max, gcd, &hellip;
      </p>

      <p>
	It can also be applied in two dimensions.  Suppose we
	have a large N&times;N array and we are looking for the
	maximum value in every M&times;M subarray of the large
	array.
      </p>

      <p>
	We tile the N&times;N array into M&times;M arrays and for
	each (i,j) we compute the maximum with respect to the
	four small rectangles that it forms inside its M&times;M
	block.
      </p>
   
      <pre>
       -----------------------------------------
      |             |             |             |
      |             |             |             |
      |             |             |             |
      |             |             |             |
       -----------------------------------------
      |             |      |      |             |
      |             |      |      |             |
      |             |----(i,j)--- |------       |
      |             |      |      |      |      |
       --------------------+-------------+------
      |             |      |      |      |      |
      |             |      |      |      |      |
      |             |       ------+------       |
      |             |             |             |
       -----------------------------------------
      </pre>

      <p>
	Now, for an arbitrary M&times;M block that spans four of
	the original tiles, we combine the precomputed values for
	the four smaller rectangles that make up this M&times;M
	block.
      </p>

      <hr class="noscreen">
      <br>


    </div>
  </div> <!-- Right column end -->


    <hr class="noscreen">

  <div class="col-l">
    <div class="col-l-in">
      <h3>Problems related to</h3>
      <ul class="menu">
        <li><a href="index-1.html#binarysearch">Searching</a></li>
        <li><a href="index-1.html#sorting">Sorting</a></li>
        <li><a href="index-1.html#graphs">Basic Graph Algorithms</a></li>
        <li><a href="index-1.html#dp">Dynamic Programming</a></li>
        <li><a href="index-1.html#greedy">Greedy Algorithms</a></li>
        <li><a href="">Computing Shortest Paths</a></li>
        <li><a href="index-1.html#heaps">Heaps</a></li>
        <li><a href="index-1.html#permutations">Permutations</a></li>
        <li><a href="index-1.html#dags">Directed Acyclic Graphs</a></li>
        <li><a href="index-1.html#prefix-sums">Computing Prefix Sums</a></li>
        <li><a href="index-1.html#sliding-window">Sliding Window Algorithms</a></li>
        <li><a href="index-1.html#advanced-graph-algorithms">Advanced Graph Algorithms</a></li>
        <li><a href="index-1.html#dp-trees">Dynamic Programming on Trees</a></li>
        <li><a href="index-1.html#range-queries">Range Queries</a></li>
        <li><a href="index-1.html#network-flows">Network Flows</a></li>
        <li><a href="index-1.html">Games and Strategies</a></li>
        <li><a href="index-1.html#geometry">Geometry</a></li>
      </ul>


      <br>

    </div>
  </div> <!-- Left column end -->

  <div class="cleaner">&nbsp;</div>

        </div> <!-- Page end -->

        <div id="footer">
                <ul>
                  <li><a href="..\index-1.html">Home</a>|</li>
                  <li><a href="../topics">Topics</a>|</li>
                  <li><a href="">Problems</a>|</li>
                  <li><a href="..\iindex\index.html">Index</a>|</li>
                  <li><a href="..\contact\index.html">Contact</a></li>
                </ul>

        <p><a href="#" onclick="print();" title="Javascript needed for a Print">Print</a> | <a href="#top">Top</a>&uarr;</p>
        </div> <!-- Footer end -->

</div> <!-- Wrapper end -->

<p id="backlinks">&copy;IARCS 2012&ndash;2016</p>
<p id="backlinks"><a href="http://www.pestujemeweb.cz/">Pěstujeme web</a> | visit: <a href="http://www.junglegym.cz/" title="Skluzavky Jungle Gym">Skluzavky</a></p>

</body>
</html>
