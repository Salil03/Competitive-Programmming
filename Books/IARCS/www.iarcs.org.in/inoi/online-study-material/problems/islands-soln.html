<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>

<meta name="Description" content="">
<meta name="author" content="">
<meta name="keywords" content="">

<meta name="robots" content="all,follow">

<!-- CSS --> 
<link rel="stylesheet" href="styles\default.css" type="text/css" media="screen, projection, tv">
<link rel="stylesheet" href="styles\print.css" type="text/css" media="print">

<!-- Favicon -->
<link rel="shortcut icon" href="img\iarcslogo.png" type="image/x-icon">
</head>

<body id="top">
<div id="wrapper">

	<div class="header">
	<h1><span><a href="http://www.iarcs.org.in/inoi"><span id="color">Indian Computing Olympiad</span></a></span></h1>
	<p id="about">Training Material</p>

	<a href="#skip-menu" class="hidden">Skip menu</a> <!-- Skip menu -->
	<div id="menu-box">
	  <ul id="web">
	    <li><a href="..\contact\index.html">Contact</a></li>
	    <li><a href="..\iindex\index.html">Index</a></li>
	    <li><a class="active" id="first" href="index-1.html">Problems</a></li>
	    <li><a href="../topics">Topics</a></li>
	    <li><a href="..\index-1.html">Home</a></li>
	  </ul>
	</div>

	</div> <!-- Header end -->

<hr class="noscreen">

<div id="skip-menu"></div>

<div class="page">
  <div class="col-r">
    <div class="col-r-in">

      <h2>
        <a href="..\topics\advanced-graph-algorithms.html">Advanced Graph Algorithms</a>&rarr;Islands (IOI 2008)
      </h2>

      <p>
        You are visiting a park which has N islands.  From each
        island i, exactly one bridge was constructed.  The length
        of that bridge is denoted by Li.  The total number of
        bridges in the park is N.  Although each bridge was built
        from one island to another, now every bridge can be
        traversed in both directions. Also, for each pair of
        islands, there is a unique ferry that travels back and
        forth between them.
      </p>

      <p>
        Since you like walking better than riding ferries, you
        want to maximize the sum of the lengths of the bridges
        you cross, subject to the constraints below.
      </p>

      <ul>
        <li> You can start your visit at an island of your choice. </li>

        <li> You may not visit any island more than once. </li>

        <li> At any time you may move from your current island S
          to another island D that you have not visited
          before. You can go from S to D either by:</li>

        <ul>
          <li> Walking: Only possible if there is a bridge
            between the two islands.  With this option the length
            of the bridge is added to the total distance you have
            walked, or </li>

          <li> Ferry: You can choose this option only if D is not
            reachable from S using any combination of bridges
            and/or previously used ferries.  (When checking
            whether it is reachable or not, you consider all
            paths, including paths passing through islands that
            you have already visited.) </li>

        </ul>
      </ul>

      <p>
        Note that you do not have to visit all the islands, and
        it may be impossible to cross all the bridges.
      </p>

      <p>
        <b>Constraints:</b>
      </p>

      <ul>
        <li>2 &le; N &le; 10<sup>6</sup></li>
        <li>1 &le; Li &le; 10<sup>8</sup> (length of bridge i)</li>
      </ul>

      <div id="solution">
        <h2>Solution</h2>
      </div>

      <p>
        The condition on taking ferries can be explained as follows:
      </p>

      <p>
        We start with an undirected graph (the bridges).  Each
        ferry we take adds an edge.  When we take a ferry we will
        add an edge &mdash; this edge can be added only if it
        connects two previously disconnected components.  So, we
        cannot add a ferry edge within the same component.
      </p>

      <p>
        The condition on how bridges were originally built
        promises us that when we start our walk (only bridges),
        each component of size K contains exactly K edges (each
        island in the component has one outgoing bridge and the
        corresponding edge stays within the component).
      </p>

      <p>
        So, graph theoretically, the problem is the following:
      </p>

      <p>
        Initially we have a graph with components.  Each
        component of size K has exactly K weighted edges.
      </p>

      <p>
        The solution is to find the longest path in each
        component and then string these paths together with ferry
        edges (remember we can start at any island and we can
        enter and leave a component at any island).
      </p>

      <p>
        How do we find the longest path in a component?  In
        general, this is hard, but we have a special case where
        there are K vertices and K edges.
      </p>

      <p>
        <b>Claim:</b> A graph with K vertices and K edges
        consists of a single cycle with trees hanging off the
        vertices along the cycle.
      </p>

      <p>
        <b>Proof:</b> We can think of the graph as being obtained
        by adding 1 edge to a tree with K vertices and K edges.
        The last edge we added creates a unique cycle.
      </p>

      <p>
      </p>

      <p> One solution is the following:
      </p>

      <ul>
        <li>
          The longest path cannot use all edges of the cycle.  If
          we omit an edge from the cycle, the rest of the graph
          is a tree.  We systematically drop each edge in the
          cycle and compute the longest path in each tree.  The
          best of these is the answer. </li>
      </ul>

      <p>
        How do we find the longest path on the tree?
      </p>

      <ul>

        <li>Root the tree at any vertex.  Run a DFS and find the
          furthest vertex v.</li>

        <li>Now root the tree at v and again do a DFS to fina the
          furthest vertex w from v.  The path v&rarr;w is the
          longest path. </li>

      </ul>

      <p>
        This algorithm takes time NC where C is the size of the cycle.
      </p>

      <p>
        To get an O(N) solution, we work as follows.
      </p>

      <p>
        Consider the C trees {T1,T2,...,TC} hanging off the cycle
        (Ti could be trivial, just the one node on the cycle).
      </p>

      <p>
        For each tree Ti, compute
      </p>

      <ul>

        <li>Ni, the longest path from a leaf node to the vertex
          where the tree is attached to the cycle</li>

        <li>Mi, the longest path within the longest path</li>

      </ul>

      <p> Now, pick two trees and a segment of the cycle so that
        the sum is maximal (enter at the first tree, walk by
        longest path to the cycle, traverse the segment of the
        cycle, exit via the second tree).
      </p>

      <hr class="noscreen">
      <br>


    </div>
  </div> <!-- Right column end -->


    <hr class="noscreen">

  <div class="col-l">
    <div class="col-l-in">
      <h3>Problems related to</h3>
      <ul class="menu">
        <li><a href="index-1.html#binarysearch">Searching</a></li>
        <li><a href="index-1.html#sorting">Sorting</a></li>
        <li><a href="index-1.html#graphs">Basic Graph Algorithms</a></li>
        <li><a href="index-1.html#dp">Dynamic Programming</a></li>
        <li><a href="index-1.html#greedy">Greedy Algorithms</a></li>
        <li><a href="">Computing Shortest Paths</a></li>
        <li><a href="index-1.html#heaps">Heaps</a></li>
        <li><a href="index-1.html#permutations">Permutations</a></li>
        <li><a href="index-1.html#dags">Directed Acyclic Graphs</a></li>
        <li><a href="index-1.html#prefix-sums">Computing Prefix Sums</a></li>
        <li><a href="index-1.html#sliding-window">Sliding Window Algorithms</a></li>
        <li><a href="index-1.html#advanced-graph-algorithms">Advanced Graph Algorithms</a></li>
        <li><a href="index-1.html#dp-trees">Dynamic Programming on Trees</a></li>
        <li><a href="index-1.html#range-queries">Range Queries</a></li>
        <li><a href="index-1.html#network-flows">Network Flows</a></li>
        <li><a href="index-1.html">Games and Strategies</a></li>
        <li><a href="index-1.html#geometry">Geometry</a></li>
      </ul>


      <br>

    </div>
  </div> <!-- Left column end -->

  <div class="cleaner">&nbsp;</div>

        </div> <!-- Page end -->

        <div id="footer">
                <ul>
                  <li><a href="..\index-1.html">Home</a>|</li>
                  <li><a href="../topics">Topics</a>|</li>
                  <li><a href="">Problems</a>|</li>
                  <li><a href="..\iindex\index.html">Index</a>|</li>
                  <li><a href="..\contact\index.html">Contact</a></li>
                </ul>

        <p><a href="#" onclick="print();" title="Javascript needed for a Print">Print</a> | <a href="#top">Top</a>&uarr;</p>
        </div> <!-- Footer end -->

</div> <!-- Wrapper end -->

<p id="backlinks">&copy;IARCS 2012&ndash;2016</p>
<p id="backlinks"><a href="http://www.pestujemeweb.cz/">Pěstujeme web</a> | visit: <a href="http://www.junglegym.cz/" title="Skluzavky Jungle Gym">Skluzavky</a></p>

</body>
</html>
